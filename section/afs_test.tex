\section{Forberedelse før test}\label{afs:tests}
Før testene kan gå i gang, skal en testplan udarbejdes således begge versioner bliver testet under samme vilkår med samme funktionaliteter. En tabel over testene kan ses i tabel \ref{tab:resultat_diskret}.
\\

Til test af begge versioner konstrueres en batteriholder til de fire celler som ses på figur \ref{fig:battery_holder}. Her er en ledning forbundet til hver celle for balancering af spændingsmåling.

\begin{figure}[h]
	\centering
	\includegraphics[width=11cm]{billeder/battery_holder.jpg}
	\caption{Batteriholder med balanceringsstik.}
	\label{fig:battery_holder}
\end{figure}

\section{Test af IC version}\label{afs:test_ic}
I dette afsnit vil en komplet test opstilling af den integrerede version af BMS'en blive gennemgået og udført. Alle implementerede funktionaliteter beskrevet i kapitel \ref{kap:funktionaliteter} testes for ønsket og optimal funktion. 

\subsection{Testopstilling}
Ved brug af en elektrisk belastning (til venstre på figur \ref{fig:ic_testsetup}) vil den maksimale afladestrøm blive testet. Der bruges en laboratoriestrømforsyning (midten til højre) til test af opladefunktionalitet. Et oscilloskop med $1^2C$ protokol dekodning bruges til aflæsning af registre og adressering. (midten til venstre) og til sidst en computer med et terminal program til brugergrænsefladen (shell). 

\begin{figure}[h]
	\centering
	\includegraphics[width=15cm]{billeder/IC_testsetup.png}
	\caption{Testopsætning til IC versionen}
	\label{fig:ic_testsetup}
\end{figure}

\subsection{Resultat skema}
Resultaterne fra testene kan ses i tabel \ref{tab:resultat_IC}.

\begin{table}[h!]
	\small
	\centering
	\begin{threeparttable}
		\begin{tabular}{ l l l l l l l }
			\toprule
			\multicolumn{1}{l}{\textbf{Funktionalitet}}          &
			\multicolumn{1}{l}{\textbf{Resultat}}           \\
			\hline
			Spændingsmålinger              & Virker                         \\
			Afladestrømmåling                    		& Virker                         \\
			Opladestrømmåling                    		& Virker ikke optimalt                         \\
			Temperaturmåling                    		& Virker                       \\
			Afladestrømsbeskyttelse		& Slår fra ved $6\ampere$        \\
			Opladestrømsbeskyttelse   	& Slår ikke fra da målingen ikke virker optimalt      \\
			Temperaturbeskyttelse          & BMS afbryder ved $\SI{45}{\celsius}$ og venter indtil nedkølet til $\SI{40}{\celsius}$           \\
			Balancering af celle 1         & Virker                         \\
			Balancering af celle 2        & Virker                         \\
			Balancering af celle 3        & Virker                         \\			
			Balancering af celle 4        & Virker                         \\
			Balancering færdig             & BMS afbryder og informerer brugeren                  \\
			Information om kapacitet       & Virker                          \\
			Information om batteriprocent 							& Virker			 \\
			Brugergrænseflade (Shell)                       & Virker                    \\
			%    &      &       \\
			
			\bottomrule
		\end{tabular}
		%\begin{tablenotes}
		%	\item[a] \textit{Kommentar}
		%\end{tablenotes}
		\caption{Sammenligning af specifikationer.}
		\label{tab:resultat_IC}
	\end{threeparttable}
\end{table} 
\FloatBlock

\subsection{Delkonklusion}
Som der ses i tabellen \ref{tab:resultat_IC} virker de fleste af funktionerne. Opladestrømmålingen fejler da der sker en fejl i konverteringen af 16-bit 2's complement tallet, og derfor returnerer et mærkeligt tal. Dette er så årsagen til at opladestrømbeskyttelsen ikke virker. Denne fejl er ikke rettet da det ikke ville være hensigtsmæssigt med hensyn til tiden. Dog er det også under afladning at beskyttelsen er mest vigtig, da man oftere kortslutter/aflader for hårdt, end man kommer til at sætte en for kraftig oplader til. 

\section{Test af diskret version}\label{afs:test_diskret}
I dette afsnit vil en komplet test opstilling af den diskrete version af BMS'en blive gennemgået og udført. Alle implementerede funktionaliteter beskrevet i kapitel \ref{kap:funktionaliteter} testes for ønsket og optimal funktion. 

\subsection{Testopstilling}
Da microen ikke monteres og derfor ikke testes på denne version, er testopstillingen lidt anderledes. 

\begin{figure}[h]
	\centering
	\includegraphics[width=15cm]{billeder/IC_testsetup.png}
	\caption{Testopsætning til IC versionen}
	\label{fig:ic_testsetup}
\end{figure}

\subsection{Resultat skema}
Resultaterne fra testene kan ses i tabel \ref{tab:resultat_diskret}.

\begin{table}[h!]
	\small
	\centering
	\begin{threeparttable}
		\begin{tabular}{ l l l l l l l }
			\toprule
			\multicolumn{1}{l}{\textbf{Funktionalitet}}          &
			\multicolumn{1}{l}{\textbf{Resultat}}           \\
			\hline
			Spændingsmålinger              & Virker                         \\
			Afladestrømmåling                    		& Virker                         \\
			Opladestrømmåling                    		& Virker ikke optimalt                         \\
			Temperaturmåling                    		& Virker                       \\
			Afladestrømsbeskyttelse		& Slår fra ved $6\ampere$        \\
			Opladestrømsbeskyttelse   	& Slår ikke fra da målingen ikke virker optimalt      \\
			Temperaturbeskyttelse          & BMS afbryder ved $\SI{45}{\celsius}$ og venter indtil nedkølet til $\SI{40}{\celsius}$           \\
			Balancering af celle 1         & Virker                         \\
			Balancering af celle 2        & Virker                         \\
			Balancering af celle 3        & Virker                         \\			
			Balancering af celle 4        & Virker                         \\
			Balancering færdig             & BMS afbryder og informerer brugeren                  \\
			Information om kapacitet       & Virker                          \\
			Information om batteriprocent 							& Virker			 \\
			Brugergrænseflade (Shell)                       & Virker                    \\
			%    &      &       \\
			
			\bottomrule
		\end{tabular}
		%\begin{tablenotes}
		%	\item[a] \textit{Kommentar}
		%\end{tablenotes}
		\caption{Sammenligning af specifikationer.}
		\label{tab:resultat_diskret}
	\end{threeparttable}
\end{table} 
\FloatBlock

\subsection{Delkonklusion}
Denne test viser at selvom der ikke kan loades software pga. en manglende microcontroller, kunne de individuelle dele stadig testes manuelt. Her ses at de fleste funktioner virker, men undtagelse til ...